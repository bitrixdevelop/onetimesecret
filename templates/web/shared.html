{{>partial/header}}

<div class="container mx-auto p-14 max-w-2xl">

  <!-- Page Component is loaded here -->
  <div id="app"></div>

  {{^verification}}
    {{#is_owner}}

      {{^show_secret}}
      <div class="bg-amber-50 border-l-4 border-amber-400 text-amber-700 p-4 mb-4 dark:bg-amber-900 dark:border-amber-500 dark:text-amber-100">
        <button type="button" class="float-right hover:text-amber-900 dark:hover:text-amber-50" onclick="this.parentElement.remove()">&times;</button>
        <strong class="font-medium">{{i18n.COMMON.warning}}</strong> {{i18n.page.you_created_this_secret}}
      </div>
      {{/show_secret}}

      {{#show_secret}}
      <div class="bg-brand-50 border-l-4 border-brand-400 text-brand-700 p-4 mb-4 dark:bg-brand-900 dark:border-brand-500 dark:text-brand-100">
        <button type="button" class="float-right hover:text-brand-900 dark:hover:text-brand-50" onclick="this.parentElement.remove()">&times;</button>
        {{i18n.page.viewed_own_secret}}
      </div>

      {{/show_secret}}

    {{/is_owner}}
  {{/verification}}

<div class="space-y-8">
    {{^show_secret}}
    {{^has_passphrase}}
    {{#verification}}
    <p class="text-md text-gray-600 dark:text-gray-400">{{i18n.COMMON.click_to_verify}}</p>
    {{/verification}}
    {{/has_passphrase}}
    {{#has_passphrase}}
    <h2 class="text-xl font-bold text-gray-800 dark:text-gray-200">{{i18n.page.requires_passphrase}}</h2>
    {{/has_passphrase}}
    {{>partial/session_messages}}
    <form method="POST" class="space-y-4">
      {{{add_shrimp}}}
      <input name="continue" type="hidden" value="true" />
      {{#has_passphrase}}
      <input type="password" name="passphrase" id="passField" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-brand-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white" placeholder="{{i18n.COMMON.enter_passphrase_here}}" />
      {{/has_passphrase}}
      <button type="submit" class="w-full px-6 py-3 text-3xl font-semibold text-white bg-brand-500 rounded-md hover:bg-brand-600 focus:outline-none focus:ring-2 focus:ring-brand-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 transition duration-150 ease-in-out">
        {{i18n.COMMON.click_to_continue}}
      </button>

    </form>
    {{^verification}}
    <div class="flex justify-between items-center mb-4">
      <h2 class="text-2xl font-bold text-gray-900 dark:text-white">{{i18n.COMMON.secret_ready}}</h2>
      <p class="text-sm text-gray-500 dark:text-gray-400 italic">{{i18n.COMMON.careful_only_see_once}}</p>
    </div>

    <div class="bg-white dark:bg-gray-900">
      <div class="max-w-7xl mx-auto py-12 px-4 sm:py-16 sm:px-6 lg:px-8">
        <div class="text-center">
          <h2 class="text-base font-semibold text-brandcomp-700 dark:text-brandcomp-600 tracking-wide uppercase opacity-40">One-Time Secret</h2>
          <h3 class="mt-1 text-3xl font-extrabold text-gray-600 dark:text-gray-300 sm:text-3xl sm:tracking-tight lg:text-4xl">You've got (secret) mail</h3>
          <p class="max-w-xl mt-5 mx-auto text-xl text-gray-500 dark:text-gray-400">A secure, one-time message awaits you. Before you open it, here's what you should know:</p>

        </div>
      </div>
    </div>
    <div class="bg-white dark:bg-gray-900">
      <div class="max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:py-12 lg:px-8">
        <div class="lg:grid lg:grid-cols-3 lg:gap-8">
          <div>
            <h3 class="text-lg font-medium text-gray-900 dark:text-white">What is this?</h3>
            <p class="mt-3 text-base text-gray-500 dark:text-gray-300">
              Onetime Secret is a secure way to share sensitive information that self-destructs after a single viewing.
            </p>
          </div>
          <div class="mt-8 lg:mt-0">
            <h3 class="text-lg font-medium text-gray-900 dark:text-white">Is it secure?</h3>
            <p class="mt-3 text-base text-gray-500 dark:text-gray-300">
              Yes. After viewing, the secret is permanently deleted from our servers, ensuring your privacy.
            </p>
          </div>
          <div class="mt-8 lg:mt-0">
            <h3 class="text-lg font-medium text-gray-900 dark:text-white whitespace-nowrap">What happens next?</h3>
            <p class="mt-3 text-base text-gray-500 dark:text-gray-300">
              When ready, click the "View Secret" button at the top of the page to reveal your one-time message.
            </p>
          </div>
        </div>
      </div>
    </div>
    {{/verification}}

    {{/show_secret}}

    {{#show_secret}}
      <div class="space-y-4">
        {{#verification}}
        <p class="text-sm text-gray-600 dark:text-gray-400">{{i18n.page.your_secret_message}}</p>
        {{/verification}}
        {{^verification}}
        <h2 class="text-gray-600 dark:text-gray-400">{{i18n.page.this_message_for_you}}</h2>
        {{/verification}}

        <div class="relative">
          <textarea
            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-brand-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white font-mono text-base leading-[1.2] tracking-wider bg-gray-100 dark:bg-gray-800 resize-none"
            readonly
            rows="{{display_lines}}"
          >{{secret_value}}</textarea>

          <button class="absolute top-2 right-2 p-1.5 bg-gray-200 dark:bg-gray-600 rounded-md hover:bg-gray-300 dark:hover:bg-gray-500 focus:outline-none focus:ring-2 focus:ring-brand-500 transition-colors duration-200" onclick="copyToClipboard(this)" aria-label="Copy to clipboard" id="copyButton">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-600 dark:text-gray-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
            </svg>
          </button>
        </div>

        <script>
        function copyToClipboard(button) {
          const textarea = button.parentElement.querySelector('textarea');
          textarea.select();
          document.execCommand('copy');

          // Change the button content to a green checkmark
          const originalContent = button.innerHTML;
          button.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>';

          // Revert back to the original content after 2 seconds
          setTimeout(() => {
            button.innerHTML = originalContent;
          }, 2000);
        }
        </script>

        {{^verification}}
        <p class="text-sm text-gray-500 dark:text-gray-400">({{i18n.COMMON.careful_only_see_once}})</p>
        {{/verification}}

        {{#truncated}}
        <div class="bg-brandcomp-100 border-l-4 border-brandcomp-500 text-blue-700 p-4 text-sm dark:bg-blue-800 dark:text-blue-200">
          <button type="button" class="float-right" onclick="this.parentElement.remove()">&times;</button>
          <strong>{{i18n.COMMON.warning}}</strong> {{i18n.page.secret_was_truncated}} {{secret_value.size.to_bytes}}.
          {{^authenticated}}<a href="/signup" class="text-brand-500 hover:underline">{{i18n.COMMON.signup_for_more}}</a>.{{/authenticated}}
        </div>
        {{/truncated}}
      </div>
      <div class="mt-4">

        {{^verification}}
        <div class="bg-gray-100 border-l-4 border-gray-400 text-gray-700 my-16 p-4 mb-4 dark:bg-gray-800 dark:border-gray-600 dark:text-gray-300">
          <button type="button" class="float-right hover:text-gray-900 dark:hover:text-gray-100" onclick="this.parentElement.remove()">&times;</button>
          <p>Once you've finished viewing the secret, feel free to navigate away from this page or close the window.</p>
        </div>
        {{/verification}}

        {{#verification}}
          <a href="/signin" class="block w-full px-4 py-2 text-center text-brand-500 bg-white border border-brand-500 rounded-md hover:bg-brand-50 focus:outline-none focus:ring-2 focus:ring-brand-500 focus:ring-offset-2 dark:bg-gray-800 dark:text-brand-400 dark:border-brand-400 dark:hover:bg-gray-700">{{i18n.COMMON.login_to_your_account}}</a>
        {{/verification}}

      </div>
      <p class="text-center pt-20 text-xs text-gray-400 dark:text-gray-600">
        <a href="https://onetimesecret.com" class="hover:underline" target="_blank" rel="noopener noreferrer">
          Powered by Onetime Secret
        </a>
      </p>

    {{/show_secret}}
  </div>


</div>
{{>partial/quiet_footer}}
