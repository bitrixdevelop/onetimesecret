import{d as D,r as g,c as n,b as e,n as V,a as d,u as C,e as h,t as c,w as N,v as M,f as E,o as r,I as B,g as I,h as A,i as j,j as F,k as S,l as R,m as z}from"./main-CPMAd0V9.js";import{u as H}from"./formSubmission-Do9DHymT.js";import{B as L}from"./BasicFormAlerts-DPHXw5mv.js";import{_ as U}from"./DomainVerificationInfo.vue_vue_type_script_setup_true_lang-BB1WjiBb.js";const X={class:"px-4 py-5 sm:p-4"},P=D({__name:"MoreInfoText",props:{textColor:{default:"text-brandcomp-800 dark:text-gray-100"},bgColor:{default:"bg-white dark:bg-gray-800"}},setup(f){const t=g(!1),o=i=>{i.preventDefault(),t.value=!t.value},s=f;return(i,_)=>(r(),n("div",{class:V(`mb-4 ${s.bgColor} shadow sm:rounded-lg relative`)},[e("div",X,[e("button",{onClick:o,class:V(`flex items-center text-base font-medium ${s.textColor} hover:text-brandcomp-600 dark:hover:text-brandcomp-400 focus:outline-none`)},[d(C(B),{icon:t.value?"heroicons:chevron-down":"heroicons:chevron-right",class:"h-5 w-5 mr-2"},null,8,["icon"]),h(" "+c(t.value?"Hide details":"Expand for more info"),1)],2),N(e("div",{class:V(["absolute left-4 right-4 mt-2 bg-gray-50 dark:bg-gray-700 shadow-lg rounded-lg overflow-hidden transition-all duration-300 ease-in-out z-10 border border-gray-200 dark:border-gray-600",{"max-h-0":!t.value,"max-h-[500px]":t.value}])},[E(i.$slots,"default")],2),[[M,t.value]])])],2))}}),W={class:"relative inline-block"},q=["aria-label"],G={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},J=e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"},null,-1),K=[J],O={key:1,class:"w-5 h-5 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},Q=e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1),Y=[Q],Z={key:0,class:"absolute z-10 px-2 py-1 text-sm text-white bg-gray-900 rounded-md bottom-full left-1/2 transform -translate-x-1/2 -translate-y-2"},ee=D({__name:"CopyButton",props:{text:{default:""},interval:{default:2e3}},setup(f){const t=f,o=g(!1),s=g(!1),i=()=>{navigator.clipboard.writeText(t.text).then(()=>{o.value=!0,s.value=!0,setTimeout(()=>{o.value=!1,s.value=!1},t.interval)})};return I(()=>{}),(_,u)=>(r(),n("div",W,[e("button",{onClick:i,onMouseenter:u[0]||(u[0]=p=>s.value=!0),onMouseleave:u[1]||(u[1]=p=>s.value=!1),class:"text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white focus:outline-none","aria-label":o.value?"Copied":"Copy to clipboard"},[o.value?(r(),n("svg",O,Y)):(r(),n("svg",G,K))],40,q),s.value?(r(),n("div",Z,c(o.value?"Copied!":"Copy to clipboard"),1)):A("",!0)]))}}),te={class:"flex bg-white dark:bg-gray-600 rounded-md"},ae={class:"w-16 flex-shrink-0 flex items-center justify-end px-3 py-2 bg-gray-100 dark:bg-gray-700 border-r border-gray-200 dark:border-gray-500",ref:"labelContainerRef"},oe={class:"flex-grow flex items-center p-3"},se={class:"flex-grow min-w-0 mr-2"},re={class:"text-gray-800 dark:text-gray-200 block truncate"},ne={key:0,class:"text-gray-400"},ie={class:"flex-shrink-0"},x=D({__name:"DetailField",props:{label:{},value:{},appendix:{}},setup(f){return(t,o)=>(r(),n("div",te,[e("div",ae,[e("span",{class:"text-sm font-medium text-gray-500 dark:text-gray-300",ref:"labelRef"},c(t.label)+":",513)],512),e("div",oe,[e("div",se,[e("span",re,[h(c(t.value),1),t.appendix?(r(),n("span",ne,c(t.appendix),1)):A("",!0)])]),e("div",ie,[d(ee,{text:t.value},null,8,["text"])])])]))}}),le={class:"max-w-2xl mx-auto p-6 bg-white dark:bg-gray-800 rounded-xl shadow-lg"},de={class:"space-y-6 mb-8"},ce={class:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg"},ue=e("h3",{class:"font-semibold text-lg mb-2 text-gray-800 dark:text-white"},"1. Create a TXT record",-1),me=e("p",{class:"mb-2 text-gray-600 dark:text-gray-300"},"Add this hostname to your DNS configuration:",-1),pe={class:"space-y-2"},he={class:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg"},ge=e("h3",{class:"font-semibold text-lg mb-2 text-gray-800 dark:text-white"},"2. Create the A record",-1),fe={class:"space-y-2"},_e=e("li",{class:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg"},[e("h3",{class:"font-semibold text-lg mb-2 text-gray-800 dark:text-white"},"3. Wait for propagation"),e("p",{class:"text-gray-600 dark:text-gray-300"},"DNS changes can take as little as 60 seconds -- or up to 24 hours -- to take effect.")],-1),ye=["disabled"],ve={class:"mt-5 flex items-start bg-white dark:bg-gray-800 p-4 rounded-md"},be=e("p",{class:"text-sm text-gray-500 dark:text-gray-400"}," It may take a few minutes for your SSL certificate to take effect once you've pointed your DNS A record. ",-1),xe=D({__name:"VerifyDomainDetails",props:{domain:{default:()=>({})},cluster:{default:()=>({})},withVerifyCTA:{type:Boolean,default:!1}},emits:["domainVerify"],setup(f,{emit:t}){const o=f,s=t,i=g(window.shrimp),_=a=>{i.value=a},{isSubmitting:u,error:p,success:k,submitForm:y}=H({url:`/api/v1/account/domains/${o.domain.display_domain}/verify`,successMessage:"Domain verification initiated successfully.",getFormData:()=>new URLSearchParams({domain:o.domain.display_domain,shrimp:i.value}),onSuccess:a=>{console.log("Verification initiated:",a),s("domainVerify",a)},onError:a=>{console.error("Verification failed:",a)},handleShrimp:_}),l=g(!1),m=j(()=>u.value||l.value),v=()=>{console.info("Refreshing DNS verification details..."),y().finally(()=>{l.value=!0,setTimeout(()=>{l.value=!1},1e4)})};return(a,b)=>{var w,$,T;return r(),n("div",le,[e("ol",de,[e("li",ce,[ue,me,e("div",pe,[d(x,{label:"Type",value:"TXT"}),d(x,{label:"Host",value:a.domain.txt_validation_host,appendix:`.${a.domain.base_domain}`},null,8,["value","appendix"]),d(x,{label:"Value",value:a.domain.txt_validation_value},null,8,["value"])])]),e("li",he,[ge,e("div",fe,[d(x,{label:"Type",value:"A"}),d(x,{label:"Host",value:(w=a.domain)!=null&&w.trd?a.domain.trd:"@",appendix:`.${($=a.domain)==null?void 0:$.base_domain}`},null,8,["value","appendix"]),d(x,{label:"Value",value:(T=a.cluster)==null?void 0:T.cluster_ip},null,8,["value"])])]),_e]),d(L,{success:C(k),error:C(p)},null,8,["success","error"]),a.withVerifyCTA?(r(),n("button",{key:0,onClick:v,disabled:m.value,class:"w-full sm:w-auto px-6 py-3 text-lg font-semibold text-white bg-brand-500 disabled:bg-gray-400 disabled:cursor-not-allowed hover:bg-brand-600 rounded-lg transition duration-100 ease-in-out"},c(C(u)?"Verifying...":"Verify Domain"),9,ye)):A("",!0),e("div",ve,[d(C(B),{icon:"mdi:information-outline",class:"h-5 w-5 text-brandcomp-700 mr-2 mt-0.5 flex-shrink-0","aria-hidden":"true"}),be])])}}}),ke={class:"container mx-auto px-4 py-8"},we=e("h1",{class:"text-3xl font-bold mb-6 text-gray-900 dark:text-white"},"Verify your domain",-1),$e={key:1,class:"text-lg mb-6 text-gray-600 dark:text-gray-300"},Ce={class:"bg-white dark:bg-gray-800 text-brand-600 dark:text-brand-400"},De={class:"px-6 py-6"},Ve={class:"max-w-xl text-base text-gray-600 dark:text-gray-300"},Ae={class:"font-bold bg-white dark:bg-gray-800 px-2 text-brand-600 dark:text-brand-400"},Te=["title"],Se=["title"],Be=e("div",{class:"mt-4 text-sm"},[e("a",{href:"#",class:"font-medium text-brandcomp-600 hover:text-brandcomp-500 dark:text-brandcomp-400 dark:hover:text-brandcomp-300"})],-1),Ne={key:3,class:"text-gray-600 dark:text-gray-400"},Fe=D({__name:"AccountDomainVerify",setup(f){const t=z(),o=g(null),s=g(null);console.log("VerifyDomain.ts",t.params.domain);const i=async()=>{var k,y;const p=t.params.domain;try{const l=await fetch(`/api/v1/account/domains/${p}`);if(!l.ok)throw new Error("Failed to fetch domain information");const m=await l.json();console.debug("json",m),o.value=m.record,m.details&&(s.value=(k=m.details)==null?void 0:k.cluster);const v=Math.floor(Date.now()/1e3),a=((y=o.value)==null?void 0:y.updated)||v;if(a){const b=v-a;b>=30?(console.debug("It has been at least 30 second since the last monitored time.",b),_.value=!0):(console.debug("It has not been 30 seconds yet since the last monitored time.",b),_.value=!1)}}catch(l){console.error("Error fetching domain:",l)}},_=g(!1),u=async p=>{console.log("Domain verified: refreshing domain info",p),await i()};return F(()=>{console.log("AccountDomainVerify component mounted"),console.log("Domain parameter:",t.params.domain),i()}),(p,k)=>{var y,l,m;return r(),n("main",ke,[we,(l=(y=o.value)==null?void 0:y.vhost)!=null&&l.last_monitored_unix?(r(),S(U,{key:0,domain:o.value,mode:"table"},null,8,["domain"])):(r(),n("p",$e,[h(" Before we can activate links for "),e("span",Ce,c((m=o.value)==null?void 0:m.display_domain),1),h(", you'll need to complete these steps. ")])),d(P,{textColor:"text-brandcomp-800 dark:text-gray-100",bgColor:"bg-white dark:bg-gray-800"},{default:R(()=>{var v,a,b,w,$;return[e("div",De,[e("div",Ve,[e("p",null,[h(" In order to connect your domain, you'll need to have a DNS A record that points "),e("span",Ae,c((v=o.value)==null?void 0:v.display_domain),1),h(" at "),e("span",{title:((a=s.value)==null?void 0:a.cluster_name)??"",class:"bg-white dark:bg-gray-800 px-2"},c((b=s.value)==null?void 0:b.cluster_ip),9,Te),h(". If you already have an A record for that address, please change it to point at "),e("span",{title:((w=s.value)==null?void 0:w.cluster_name)??"",class:"bg-white dark:bg-gray-800 px-2"},c(($=s.value)==null?void 0:$.cluster_ip),9,Se),h(" and remove any other A, AAAA, or CNAME records for that exact address. ")])]),Be])]}),_:1}),o.value&&s.value?(r(),S(xe,{key:2,domain:o.value,cluster:s.value,withVerifyCTA:_.value,onDomainVerify:u},null,8,["domain","cluster","withVerifyCTA"])):(r(),n("p",Ne,"Loading domain information..."))])}}});export{Fe as default};
